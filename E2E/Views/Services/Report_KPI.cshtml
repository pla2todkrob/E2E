@{
	ViewBag.Title = "Report KPI";
	Layout = "~/Views/Shared/_LayoutFluid.cshtml";
}

@section breadcrumb{
    <nav aria-label="breadcrumb ">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="@Url.Action("Index","Home")">Home</a></li>
            <li class="breadcrumb-item">Department</li>
            <li class="breadcrumb-item active" aria-current="page">Report KPI</li>
        </ol>
    </nav>
}

@section scripts{
    <script>
        $(function () {
            reloadTable();

        });

        function callOverdueModal() {
            $.ajax({
                url: '@Url.Action("Report_KPI_Overdue", "Services")',
                data: {
                    filter:getQueryString()
                },
                async: true,
                success: function (res) {
                    $('#modalContent').parent().addClass('modal-xl');

                    $('#modalContent').html(res);

                    $('#modalArea').modal('show');
                }
            });
            return false;
        }

        function callUnsatisfiedModal() {
            $.ajax({
                url: '@Url.Action("Report_KPI_Unsatisfied", "Services")',
                data: {
                    filter:getQueryString()
                },
                async: true,
                success: function (res) {
                    $('#modalContent').parent().addClass('modal-xl');

                    $('#modalContent').html(res);

                    $('#modalArea').modal('show');
                }
            });
            return false;
        }

        function callUserTaskModal(id) {
            $.ajax({
                url: '@Url.Action("Report_KPI_View", "Services")',
                data: {
                    id: id,
                    filter:getQueryString()
                },
                async: true,
                success: function (res) {
                    $('#modalContent').parent().addClass('modal-xl');

                    $('#modalContent').html(res);

                    $('#modalArea').modal('show');
                }
            });
            return false;
        }

        function callJoinTeamModal(id) {
            $.ajax({
                url: '@Url.Action("Report_KPI_JoinTeam", "Services")',
                data: {
                    id: id,
                    filter:getQueryString()
                },
                async: true,
                success: function (res) {
                    $('#modalContent').parent().addClass('modal-xl');

                    $('#modalContent').html(res);

                    $('#modalArea').modal('show');
                }
            });
            return false;
        }

       function reloadTable() {
           callFilter('@Url.Action("Report_KPI_Filter", "Services")').then(function () {
               callTable_Normal('@Url.Action("Report_KPI_Table", "Services")');
           });

        }
    </script>
}

<div class="mb-3 d-flex">
    <div>
        <button type="button" class="btn btn-light" onclick="confirmAndPerformAjaxRequest('@Url.Action("SetClosePrevious","Services")','reloadTable')">
            <i class="fa fa-th-list mr-2" aria-hidden="true"></i>
            Closing of previous months'
        </button>
    </div>
    <div class="ml-auto" id="filter"></div>
</div>
<div id="datalist"></div>
